#!/usr/bin/env python
"""lammps.py - auto-generated by softnanotools"""
from pathlib import Path
from typing import Union, List
import pandas as pd

from softnanotools.logger import Logger
logger = Logger(__name__)

def write_LAMMPS_dump(
    data: pd.DataFrame,
    fname: Union[str, Path],
    timestep: int,
    box: List[float],
):
    data = data.copy()
    types = list(set(data['type']))
    data['type'] = data['type'].apply(lambda x: types.index(x) + 1)
    with open(fname, 'w') as f:
        f.write(f'ITEM: TIMESTEP\n{timestep}\n')
        f.write(f'ITEM: NUMBER OF ATOMS\n{len(data)}\n')
        f.write(
            f'ITEM: BOX BOUNDS pp pp pp\n'
            f'{-box[0]/2} {box[0]/2}\n'
            f'{-box[1]/2} {box[1]/2}\n'
            f'{-box[2]/2} {box[2]/2}\n'
        )
        f.write(f'ITEM: ATOMS {" ".join(data.columns)}\n')
        data.to_csv(
            f,
            sep=' ',
            header=None,
            index=None
        )

    return

if __name__ == '__main__':
    import doctest
    doctest.testmod()
