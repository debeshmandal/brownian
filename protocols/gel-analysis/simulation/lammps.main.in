# Hydrogels Equilibration Script

variable fname string /home/debesh/phd/hydrogel/0011-generate-ABC/configs/lammps.A17.conf
variable fout string data.out
variable bond_length equal 1.0
variable bond_strength equal 2.5
variable lj_eps equal 1.0
variable lj_sig equal 1.0
variable lj_cut equal 1.12
variable T equal 0.05
variable steps equal 10000
variable thermo equal 1000
variable dt equal 0.012
variable global_cutoff equal 15
variable comm_cutoff equal "v_global_cutoff + 0.4"

units		lj
atom_style	bond
bond_style  harmonic
pair_style	lj/cut ${lj_cut}
read_data	${fname}

bond_coeff	* ${bond_strength} ${bond_length}
pair_coeff	* * ${lj_eps} ${lj_sig} ${lj_cut}

comm_modify cutoff ${comm_cutoff}

group crosslinkers type 2

neighbor	0.4 bin
neigh_modify	every 1 delay 1 page 100000000 one 1000000

fix		1 all nve
fix		2 all langevin ${T} ${T} 10.0 904297
fix		3 all recenter 0.0 0.0 0.0

# compute gyration radius
compute gyr all gyration

# calculate density profile

# compute rdf of all
compute rdf_N all rdf 100 * * cutoff ${global_cutoff}

# compute rdf of all
compute rdf_X crosslinkers rdf 100 2 2 cutoff ${global_cutoff}

# compute density profile
compute rho all chunk/atom bin/sphere 0 0 0 0.0 20.0 20 discard yes

# compute neighbours histogram

minimize 0.0 1.0e-8 1000 100000
reset_timestep 0

thermo  ${thermo}
timestep	${dt}

fix rdf_out all ave/time 10 100 ${steps} c_rdf_N[*] c_rdf_X[*] file ${fout} mode vector
fix gyr_out all ave/time 10 100 1000 c_gyr file gyr.out
fix rho_out all ave/histo 10 100 ${steps} 0.0 20.0 20 c_rho[*] file rho.out mode vector kind peratom

dump output all custom 10000 dump.atom.* id type x y z c_rho

run		${steps}
